{"componentChunkName":"component---src-templates-blog-post-js","path":"/link-ndk-with-gradle/","result":{"data":{"site":{"siteMetadata":{"title":"Blog.kt"}},"markdownRemark":{"id":"1e25a0b8-b157-5bb0-b46a-5968a18041ff","excerpt":"前言 最近在倒腾Mpg123-Android的时候，尝试了把 ndk-build 关联到 Gradle 中。不需要单独执行  指令来构建  了。在使用此种方式后，有些小发现，和诸君分享。 怎么关联 在模块级别的文件中指定如下： 优劣 优势：IDE…","html":"<h2>前言</h2>\n<p>最近在倒腾<a href=\"https://github.com/rosuH/MPG123-Android\">Mpg123-Android</a>的时候，尝试了把 ndk-build 关联到 Gradle 中。不需要单独执行 <code class=\"language-text\">ndk-build</code> 指令来构建 <code class=\"language-text\">so</code> 了。在使用此种方式后，有些小发现，和诸君分享。</p>\n<h2>怎么关联</h2>\n<p>在模块级别的<code class=\"language-text\">build.gradle</code>文件中指定如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\">android {\n    ...\n    externalNativeBuild {\n        ndkBuild {\n             // native 编译配置文件位置\n            path file('src/main/jni/Android.mk')\n            // so 产物输出文件夹，编译后会输出到 $buildStagingDirectory/ndkBuild/.. 下面\n            buildStagingDirectory \"src/main/libs\"\n        }\n    }\n}</code></pre></div>\n<h2>优劣</h2>\n<ul>\n<li>优势：IDE 支持跳转、语法检测、编译运行直接生效，不需要自己执行 <code class=\"language-text\">ndk-build</code> 生成新的 <code class=\"language-text\">so</code> 文件。（开发这个 Native 项目的时候）提高开发效率</li>\n<li>劣势：重新构建项目的时候会编译这些 Native 项目，（不开发这个 Native 项目的时候）直接降低了开发效率</li>\n</ul>\n<h2>使用场景和解决方法</h2>\n<ul>\n<li>开源库：建议关联 Gradle，理由：\n<ul>\n<li>一般情况下开发这个 Native 就是唯一的工作，所以不存在编译影响开发效率的情况</li>\n<li>不需要手动生产 So，即便是创建 release，用户拉取你的库的时候，也会自动编译 so，和手动编译放到库里没有差别。</li>\n</ul>\n</li>\n</ul>\n<p>其他时候，主要看项目大小和核心功能。一般来说</p>\n<ul>\n<li>项目比较大，功能丰富，不总是需要对这个 Native 开发的时候，那么不要关联是最好的。因为项目总是需要频繁重新构建，如果耗费大量时间去编译无关迭代的模块，肯定很不值得</li>\n<li>核心和此 Native 相关，频繁迭代，或者是模块负责人，那么肯定关联最好了。</li>\n</ul>\n<hr>\n<p>参看：</p>\n<ul>\n<li><a href=\"https://developer.android.com/studio/projects/gradle-external-native-builds#configure-gradle\">Link Gradle to your native library</a></li>\n<li><a href=\"http://google.github.io/android-gradle-dsl/current/com.android.build.gradle.internal.dsl.NdkBuildOptions.html\">NdkBuildOptions</a></li>\n</ul>","frontmatter":{"title":"将 ndk-build 关联到 Gradle","date":"2020-03-08","description":"最近在倒腾 Mpg123-Android 的时候，尝试了把 ndk-build 关联到 Gradle 中。不需要单独执行 `ndk-build` 指令来构建 `so` 了。在使用此种方式后，有些小发现，和诸君分享。","excerpt":null}},"previous":{"fields":{"slug":"Android-reading-note-summary"},"frontmatter":{"title":"Android 札记系列迁移告知"}},"next":{"fields":{"slug":"2021-05-26-av-basic-pcm-samplerate-bit-depth-and-bitrate-and-more"},"frontmatter":{"title":"音视频基础概念：PCM、采样率、位深和比特率"}}},"pageContext":{"id":"1e25a0b8-b157-5bb0-b46a-5968a18041ff","previousPostId":"deffbea4-96a0-5637-9511-227c71891a5a","nextPostId":"db50fc59-6152-5eb2-8f10-9daa5d4661d3"}},"staticQueryHashes":["2082311839","2355076697","959449634"],"slicesMap":{}}